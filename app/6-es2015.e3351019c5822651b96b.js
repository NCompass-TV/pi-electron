(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{Kw5A:function(e,t,s){"use strict";s.r(t),s.d(t,"PlayerModule",function(){return O});var i=s("ofXK"),n=s("tyNb"),l=s("fXoL");let o=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=l.Ab({type:e,selectors:[["app-layout"]],decls:1,vars:0,template:function(e,t){1&e&&l.Hb(0,"router-outlet")},directives:[n.d],styles:[""]}),e})();var r=s("jifJ"),c=s("AytR"),a=s("IStn"),p=s("TLjN"),_=s("mR6p"),u=function(e){return e[e.webm=1]="webm",e}({}),h=function(e){return e[e.jpeg=1]="jpeg",e[e.jpg=2]="jpg",e[e.jfif=3]="jfif",e[e.png=4]="png",e[e.webp=5]="webp",e}({}),y=function(e){return e[e.feed=1]="feed",e}({});let d=(()=>{class e{transform(e,...t){if(e in u)return!0}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=l.Fb({name:"isVideo",type:e,pure:!0}),e})(),f=(()=>{class e{transform(e,...t){if(e in h)return!0}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=l.Fb({name:"isImage",type:e,pure:!0}),e})(),b=(()=>{class e{transform(e,...t){if(e in y)return!0}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=l.Fb({name:"isFeed",type:e,pure:!0}),e})();var g=s("jhN1");let m=(()=>{class e{constructor(e){this._sanitizer=e}transform(e){return this._sanitizer.bypassSecurityTrustResourceUrl(e)}}return e.\u0275fac=function(t){return new(t||e)(l.Gb(g.b))},e.\u0275pipe=l.Fb({name:"sanitize",type:e,pure:!0}),e})();const w=["video_player"];function k(e,t){if(1&e){const e=l.Mb();l.Jb(0),l.Lb(1,"video",1,2),l.Sb("ended",function(){return l.bc(e),l.Ub().onVideoEnded()})("error",function(t){return l.bc(e),l.Ub().mediaFileError(t)}),l.Kb(),l.Ib()}if(2&e){const e=l.Ub();l.wb(1),l.Xb("src",e.asset_url,l.dc)("muted",!0)("loop",e.one_asset_playlist)}}function v(e,t){if(1&e&&(l.Jb(0),l.Hb(1,"img",3),l.Ib()),2&e){const e=l.Ub();l.wb(1),l.Xb("src",e.asset_url,l.dc)}}function q(e,t){if(1&e&&(l.Jb(0),l.Hb(1,"iframe",4),l.Vb(2,"sanitize"),l.Ib()),2&e){const e=l.Ub();l.wb(1),l.Xb("src",l.Wb(2,1,e.asset_url),l.cc)}}let F=(()=>{class e{constructor(e){this._player=e,this.playlist_id="",this.is_fullscreen=new l.n,this.playlist_content=[],this.one_asset_playlist=!1,this.asset_url="",this.asset_duration=0,this.asset_filetype="",this.asset_sequence=0}ngOnInit(){this.getPlaylistData()}getPlaylistData(){this._player.get_playlist_by_id(this.playlist_id).subscribe(e=>{this.playlist_content=e.sort((e,t)=>e.sequence.toString().localeCompare(t.sequence.toString())),this.one_asset_playlist=1==this.playlist_content.length,this.checkFileType(this.asset_sequence)})}checkFileType(e){this.playlist_content[e].file_type in u?this.displayVideo(this.playlist_content[e]):this.playlist_content[e].file_type in h?this.displayImage(this.playlist_content[e]):this.playlist_content[e].file_type in y&&this.displayFeed(this.playlist_content[e])}displayVideo(e){this.asset_url=`${c.a.local.assets}/${e.file_name}`,this.asset_filetype=e.file_type,this.is_fullscreen.emit(1==e.is_fullscreen)}displayImage(e){this.asset_url=`${c.a.local.assets}/${e.file_name}`,this.asset_filetype=e.file_type,this.is_fullscreen.emit(1==e.is_fullscreen),this.one_asset_playlist||setTimeout(()=>{this.asset_sequence+=1,this.checkFileType(this.asset_sequence<this.playlist_content.length?this.asset_sequence:this.asset_sequence=0)},1e3*e.duration||2e4)}displayFeed(e){this.asset_url=`${c.a.local.assets}/${e.content_id}`,this.asset_filetype=e.file_type,console.log("Asset Sequence",this.asset_sequence),this.is_fullscreen.emit(1==e.is_fullscreen),this.one_asset_playlist||setTimeout(()=>{this.asset_sequence+=1,this.checkFileType(this.asset_sequence<this.playlist_content.length?this.asset_sequence:this.asset_sequence=0)},1e3*e.duration||2e4)}onVideoEnded(){this.one_asset_playlist||(this.asset_sequence+=1,this.checkFileType(this.asset_sequence<this.playlist_content.length?this.asset_sequence:this.asset_sequence=0))}mediaFileError(e){console.log(e)}}return e.\u0275fac=function(t){return new(t||e)(l.Gb(p.a))},e.\u0275cmp=l.Ab({type:e,selectors:[["app-playlist"]],viewQuery:function(e,t){if(1&e&&l.kc(w,!0),2&e){let e;l.ac(e=l.Tb())&&(t.video_player=e.first)}},inputs:{playlist_id:"playlist_id"},outputs:{is_fullscreen:"is_fullscreen"},decls:6,vars:9,consts:[[4,"ngIf"],["autoplay","",3,"src","muted","loop","ended","error"],["video_player",""],[3,"src"],["frameborder","0",3,"src"]],template:function(e,t){1&e&&(l.fc(0,k,3,3,"ng-container",0),l.Vb(1,"isVideo"),l.fc(2,v,2,1,"ng-container",0),l.Vb(3,"isImage"),l.fc(4,q,3,3,"ng-container",0),l.Vb(5,"isFeed")),2&e&&(l.Xb("ngIf",l.Wb(1,3,t.asset_filetype)),l.wb(2),l.Xb("ngIf",l.Wb(3,5,t.asset_filetype)),l.wb(2),l.Xb("ngIf",l.Wb(5,7,t.asset_filetype)))},directives:[i.j],pipes:[d,f,b,m],styles:["video[_ngcontent-%COMP%]{background-color:#000;-o-object-fit:fill;object-fit:fill}iframe[_ngcontent-%COMP%], img[_ngcontent-%COMP%], video[_ngcontent-%COMP%]{width:100%;height:100%}iframe[_ngcontent-%COMP%]{border:0}"]}),e})();const I=function(e,t,s,i,n,l){return{background:e,"width.px":t,"height.px":s,"left.px":i,"top.px":n,"z-index":l}};let C=(()=>{class e{constructor(){this.background="",this.height="",this.order=0,this.playlist_id="",this.playlist_type="",this.pos_x="",this.pos_y="",this.width="",this.is_fullscreen=!1}ngOnInit(){}toFullscreen(e){this.is_fullscreen=1==e}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=l.Ab({type:e,selectors:[["app-zone"]],inputs:{background:"background",height:"height",order:"order",playlist_id:"playlist_id",playlist_type:"playlist_type",pos_x:"pos_x",pos_y:"pos_y",width:"width"},decls:2,vars:10,consts:[[1,"zone",3,"ngStyle","ngClass"],[3,"playlist_id","is_fullscreen"]],template:function(e,t){1&e&&(l.Lb(0,"div",0),l.Lb(1,"app-playlist",1),l.Sb("is_fullscreen",function(e){return t.toFullscreen(e)}),l.Kb(),l.Kb()),2&e&&(l.Xb("ngStyle",l.Zb(3,I,t.background,t.width,t.height,t.pos_x,t.pos_y,t.order))("ngClass",t.is_fullscreen?"fullscreen":""),l.wb(1),l.Xb("playlist_id",t.playlist_id))},directives:[i.k,i.h,F],styles:[".zone[_ngcontent-%COMP%]{position:absolute;overflow:hidden}.fullscreen[_ngcontent-%COMP%]{background-color:#000;position:fixed;height:100%!important;width:100%!important;z-index:9!important;top:0!important;left:0!important}"]}),e})();function x(e,t){if(1&e&&(l.Jb(0),l.Hb(1,"app-zone",2),l.Ib()),2&e){const e=t.$implicit;l.wb(1),l.Xb("background",e.background)("height",e.height)("order",e.zone_order)("playlist_id",e.playlist_id)("pos_x",e.x_pos)("pos_y",e.y_pos)("width",e.width)}}const z=[{path:"",component:o,children:[{path:"",component:(()=>{class e{constructor(e,t,s){this._player=e,this._router=t,this._setup=s,this.template_zones=[],this.socket_client=r.io(c.a.local.api,{query:"connecting_as=angular_play_page"}),this._setup.get_player_license().subscribe(e=>{console.log(e),this.pi_license=e[0]})}ngOnInit(){this.getTemplate(),this.socket_onConnect(),this.socket_onContentUpdate(),this.socket_onResetPlayer()}ngOnDestroy(){this.socket_client.disconnect()}socket_onConnect(){this.socket_client.on(a.a.connection,()=>{console.log("Connected to Local Socket Server")})}socket_onContentUpdate(){this.socket_client.on(a.a.content_update,()=>{var e;this._router.navigate(["/getting-ready"],{queryParams:{license_key:null===(e=this.pi_license)||void 0===e?void 0:e.license_key}})})}socket_onResetPlayer(){this.socket_client.on(a.a.reset,()=>{this._router.navigate(["/reset"])})}getTemplate(){this._player.get_template().subscribe(e=>{this.template_zones=e})}}return e.\u0275fac=function(t){return new(t||e)(l.Gb(p.a),l.Gb(n.b),l.Gb(_.a))},e.\u0275cmp=l.Ab({type:e,selectors:[["app-play"]],decls:2,vars:1,consts:[["id","player",1,"player"],[4,"ngFor","ngForOf"],[3,"background","height","order","playlist_id","pos_x","pos_y","width"]],template:function(e,t){1&e&&(l.Lb(0,"div",0),l.fc(1,x,2,7,"ng-container",1),l.Kb()),2&e&&(l.wb(1),l.Xb("ngForOf",t.template_zones))},directives:[i.i,C],styles:[""]}),e})()}]}];let O=(()=>{class e{}return e.\u0275mod=l.Eb({type:e}),e.\u0275inj=l.Db({factory:function(t){return new(t||e)},imports:[[i.b,n.c.forChild(z)]]}),e})()}}]);